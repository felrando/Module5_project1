---
title: "Weather Information Preferences"
subtitle: "Report for the `r params$region` Region"
author: "Author: UrMom"
date: "`r format(Sys.Date(), '%A, %B, %d, %Y') `"
output: html_document
params:
  region: 
    label: "Region"
    value: Mountain
    input: select
    choices: ["East North Central","East South Central", 
              "Middle Atlantic","Mountain", "New England", 
              "Pacific","South Atlantic", "West North Central",
              "West South Central"]



---


```{r setup, include=FALSE}
# define knitr options
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)

# set any missing NAs in table to blank
options(knitr.kable.NA='')

# load R packages
library(fivethirtyeight)
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggthemes)

# load steak_survey dataset
data("weather_check", package="fivethirtyeight")

# create subset, no missing NAs
# pick a specific region
sdat <- weather_check %>%
  filter(region=="Pacific")

#Module 3 - Lesson: Building a Document Template, part 2

```

Module 3 - Lesson: Adding Parameters in a Document Template

The text sections and R code chunks have been updated with the params$region substitutions as needed for this lesson.


```{r child='text/backgroundSection.Rmd'}
```

```{r child='text/purposeSection.Rmd'}
```


## Demographics of Survey Respondents in a Merged Table

This section provides demographic summary tables for the `r nrow(sdat)` survey respondents.

```{r maketable, code=readLines("code/makeTable.R")}
```


## Weather Source Preference by Gender

Finally, here is a breakdown of the `r nrow(sdat)` survey respondents for the `r params$region` region of the US on how they check their daily weather by gender.

```{r}
library(stringr)
ggplot(sdat, 
       aes(x = weather_source, fill = female)) + 
  geom_bar(position="dodge",colour="black") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
  ggtitle(paste0("Weather Source by Gender: ",
                 params$region," Region")) +
  xlab("Weather Source Preference") +
  ylab("Number of Respondents") +
  scale_fill_manual(values=c("skyblue","palevioletred"),
    name="Gender",
    breaks=c(FALSE,TRUE),
    labels=c("Male", "Female")) +
  coord_flip() +
  theme_fivethirtyeight()
```
